!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ReachRouter=e()}(this,function(){var r=Object.prototype.hasOwnProperty,e={};function n(){try{return window}catch(t){try{return global}catch(t){return e}}}function a(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);return t}try{var u=3==Function("a","return a + 1")(2)}catch(t){}function t(t,e,n,r){var o=t.name||"IEComponent",i=u?Function("superClass","ctor","return function "+o+" (props, context) {\n            superClass.apply(this, arguments); \n            ctor.apply(this, arguments);\n      }")(e,t):function(){e.apply(this,arguments),t.apply(this,arguments)};return i.displayName=o,a(function(t,e){function n(){}var r=t.prototype;n.prototype=e.prototype;var o=t.prototype=new n;return a(o,r),o.constructor=t,o}(i,e),n),r&&a(i,r),i}function m(t,e){return t.slice(0,e.length)===e}var b=["uri","path"];function E(t,e){if(!t)throw e}function P(t,e){for(var n=void 0,r=void 0,o=O(e.split("?").shift()),i=""===o[0],a=t.map(x).sort(w),u=0,c=a.length;u<c;u++){var s=!1,l=a[u].route;if(l.default)r={route:l,params:{},uri:e};else{for(var p=O(l.path),f={},h=Math.max(o.length,p.length),v=0;v<h;v++){var d=p[v],m=o[v];if("*"===d){f["*"]=o.slice(v).map(decodeURIComponent).join("/");break}if(void 0===m){s=!0;break}var y=j.exec(d);if(y&&!i){E(!b.includes(y[1]),'<Router> dynamic segment "'+y[1]+'" is a reserved name. Please use a different name in path "'+l.path+'".');var g=decodeURIComponent(m);f[y[1]]=g}else if(d!==m){s=!0;break}}if(!s){n={route:l,params:f,uri:"/"+o.slice(0,v).join("/")};break}}}return n||r||null}function C(t,e){if(m(t,"/"))return t;var n=t.split("?"),r=n[0],o=n[1],i=e.split("?").shift(),a=O(r),u=O(i);if(""===a[0])return d(i,o);if(!m(a[0],"."))return d(("/"===i?"":"/")+u.concat(a).join("/"),o);for(var c=u.concat(a),s=[],l=0,p=c.length;l<p;l++){var f=c[l];".."===f?s.pop():"."!==f&&s.push(f)}return d("/"+s.join("/"),o)}function c(t,n){return"/"+O(t).map(function(t){var e=j.exec(t);return e?n[e[1]]:t}).join("/")}var j=/^:(.+)/,o=4,i=3,s=2,l=1,p=1,f=function(t){return""==t},h=function(t){return j.test(t)},v=function(t){return"*"===t};function x(t,e){return{route:t,score:t.default?0:O(t.path).reduce(function(t,e){return t+=o,f(e)?t+=p:h(e)?t+=s:v(e)?t-=o+l:t+=i,t},0),index:e}}function w(t,e){return t.score<e.score?1:t.score>e.score?-1:t.index-e.index}function O(t){return t.replace(/(^\/+|\/+$)/g,"").split("/")}function d(t,e){return t+(e?"?"+e:"")}var y={};function g(t){return Object.assign({},t.location,{getPath:function(){return"hash"===y.value?this.hash.slice(1):this.pathname},state:t.history.state,key:t.history.state&&t.history.state.key||"initial"})}function R(u){var c=[],s=!1,l=function(){},p={location:g(u),transitioning:s,_onTransitionComplete:function(){p.transitioning=s=!1,l()},listen:function(r){c.push(r);var t,e,n,o=function(t){p.location=g(u),r()},i="hash"===y.value?"hashchange":"popstate";return e=i,n=o,(t=u).addEventListener?t.addEventListener(e,n):t.attachEvent&&t.attachEvent("on"+e,n),function(){var t,e,n;e=i,n=o,(t=u).removeEventListener?t.removeEventListener(e,n):t.detachEvent&&t.detachEvent("on"+e,n),c=c.filter(function(t){return t!==r})}},navigate:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.state,r=t.replace,o=void 0!==r&&r;n=Object.assign({},n,{key:Date.now()+""});var i=u.location;if("hash"===y.value)o&&i.hash!==newHash&&history.back(),i.hash=e;else try{s||o?u.history.replaceState(n,null,e):u.history.pushState(n,null,e)}catch(t){i[o?"replace":"assign"](e)}p.location=g(u),p.transitioning=s=!0;var a=new Promise(function(t){return l=t});return c.forEach(function(t){return t()}),a}};return p}function F(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"/",r=0,o=[],i=[{pathname:t,search:""}],a={addEventListener:function(t,e){},removeEventListener:function(t,e){},history:{back:function(){},pushState:function(t,e,n){r++,i.push(k(n)),o.push(t),u(a)},replaceState:function(t,e,n){i[r]=k(n),o[r]=t,u(a)}}};function u(t){var e=t.history;e.index=r,e.entries=i,e.state=o[r],t.location=i[r]}return u(a),a}function k(t){var e=t.split("?");return{pathname:e[0],search:e[1]||""}}var L=n(),D=R(L.location?L:F()),S=D.navigate,T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function q(t,e){var n={};for(var r in t)0<=e.indexOf(r)||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var U=n(),M=!!U.history&&U.history.pushState,I=U.React;if(!I||!I.eventSystem)throw"请先安装anujs";var K=I.unstable_deferredUpdates,N=I.PropTypes,$=I.cloneElement,_=I.PureComponent,H=I.createContext,W=I.Children,B=I.Component;void 0===K&&(K=function(t){return t()});var Y=function(t,e){var n=H(e);return n.Consumer.displayName=t+".Consumer",n.Provider.displayName=t+".Provider",n},z=Y("Location"),A=function(t){var e=t.children;return I.createElement(z.Consumer,null,function(t){return t?e(t):I.createElement(G,null,e)})},G=t(function(){this.state={context:this.getContext(),refs:{unlisten:null}}},B,{getContext:function(){var t=this.props.history;return{navigate:t.navigate,location:t.location}},componentDidCatch:function(t,e){if(!it(t))throw t;(0,this.props.history.navigate)(t.uri,{replace:!0})},componentDidUpdate:function(t,e){e.context.location!==this.state.context.location&&this.props.history._onTransitionComplete()},componentDidMount:function(){var t=this,e=this.state.refs,n=this.props.history;e.unlisten=n.listen(function(){Promise.resolve().then(function(){K(function(){t.unmounted||t.setState(function(){return{context:t.getContext()}})})})})},componentWillUnmount:function(){var t=this.state.refs;this.unmounted=!0,t.unlisten()},render:function(){var t=this.state.context,e=this.props.children;return I.createElement(z.Provider,{value:t},"function"==typeof e?e(t):e||null)}},{defaultProps:{history:D}}),J=Y("Base",{baseuri:"/",basepath:"/"});function Q(n){return y.value=!M||n.mode&&"history"!==n.mode?"hash":"history",I.createElement(J.Consumer,null,function(e){return I.createElement(A,null,function(t){return I.createElement(V,T({},e,t,n))})})}var V=t(function(){},_,{render:function(){var t=this.props,e=t.location,n=t.navigate,r=t.basepath,o=t.primary,i=t.children,a=t.component,u=void 0===a?"div":a,c=(t.baseuri,t.mode),s=q(t,["location","navigate","basepath","primary","children","component","baseuri","mode"]),l=P(W.map(i,lt(r)),e.getPath());if(l){var p=l.params,f=l.uri,h=l.route,v=l.route.value;r=h.default?r:h.path.replace(/\*$/,"");var d=Object.assign({},p,{uri:f,location:e,navigate:function(t,e){return n(C(t,f),e)}}),m=$(v,d,v.props.children?I.createElement(Q,{primary:o,mode:c},v.props.children):void 0),y=o?Z:u,g=o?Object.assign({uri:f,location:e},s):s;return I.createElement(J.Provider,{value:{baseuri:f,basepath:r}},I.createElement(y,g,m))}return null}},{defaultProps:{primary:!0}}),X=Y("Focus"),Z=function(t){var e=t.uri,n=t.location,r=q(t,["uri","location"]);return I.createElement(X.Consumer,null,function(t){return I.createElement(nt,T({},r,{requestFocus:t,uri:e,location:n}))})},tt=!0,et=0,nt=t(function(){var e=this;this.state={},this.requestFocus=function(t){e.state.shouldFocus||t.focus()}},B,{componentDidMount:function(){et++,this.focus()},componentWillUnmount:function(){0===--et&&(tt=!0)},componentDidUpdate:function(t,e){t.location!==this.props.location&&this.state.shouldFocus&&this.focus()},focus:function(){if(!n().process){var t=this.props.requestFocus;t?t(this.node):tt?tt=!1:this.node.focus()}},render:function(){var e=this,t=this.props,n=(t.children,t.style),r=(t.requestFocus,t.role),o=void 0===r?"group":r,i=t.component,a=void 0===i?"div":i,u=(t.uri,t.location,q(t,["children","style","requestFocus","role","component","uri","location"]));return I.createElement(a,T({style:Object.assign({outline:"none"},n),tabIndex:"-1",role:o,ref:function(t){return e.node=t}},u),I.createElement(X.Provider,{value:this.requestFocus},this.props.children))}},{getDerivedStateFromProps:function(t,e){if(null==e.uri)return Object.assign({shouldFocus:!0},t);var n=t.uri!==e.uri,r=t.location.getPath(),o=e.location.getPath()!==r&&r===t.uri;return Object.assign({shouldFocus:n||o},t)}});function rt(){}function ot(t){this.uri=t}var it=function(t){return t instanceof ot},at=function(t){throw new ot(t)},ut=t(function(){},B,{componentDidMount:function(){var t=this.props,e=t.navigate,n=t.to,r=(t.from,t.replace),o=void 0===r||r,i=t.state;t.noThrow;e(c(n,q(t,["navigate","to","from","replace","state","noThrow"])),{replace:o,state:i})},render:function(){var t=this.props,e=(t.navigate,t.to),n=(t.from,t.replace,t.state,t.noThrow),r=q(t,["navigate","to","from","replace","state","noThrow"]);return n||at(c(e,r)),null}}),ct=function(e){return I.createElement(A,null,function(t){return I.createElement(ut,T({},t,e))})};ct.propTypes={from:N.string,to:N.string.isRequired};var st=function(t){return t.replace(/(^\/+|\/+$)/g,"")},lt=function(a){return function(t){var e,n,r;if(E(t.props.path||t.props.default||t.type===ct,'<Router>: Children of <Router> must have a "path" or "default" prop, or be a "<Redirect>". \n         None found on element type "'+t.type+'"'),E(!!(t.type!==ct||t.props.from&&t.props.to),'<Redirect from="'+t.props.from+' to="'+t.props.to+'"/> requires both "from" and "to" props when inside a <Router>.'),E(!(t.type===ct&&(e=t.props.from,n=t.props.to,r=function(t){return h(t)},O(e).filter(r).sort().join("/")!==O(n).filter(r).sort().join("/"))),'<Redirect from="'+t.props.from+' to="'+t.props.to+'"/> has mismatched dynamic segments, ensure both paths have the exact same dynamic segments.'),t.props.default)return{value:t,default:!0};var o=t.type===ct?t.props.from:t.props.path,i="/"===o?a:st(a)+"/"+st(o);return{value:t,default:t.props.default,path:t.props.children?st(i)+"/*":i}}};return{version:"2.2.1",Link:function(d){return I.createElement(J.Consumer,null,function(t){t.basepath;var v=t.baseuri;return I.createElement(A,null,function(t){var e=t.location,n=t.navigate,r={},o=void 0,i=void 0,a=void 0,u=rt;for(var c in d){var s=d[c];"to"===c?o=s:"state"===c?i=s:"replace"===c?a=s:"getProps"==c&&s?u=s:r[c]=s}var l=C(o,v),p=e.getPath()===l,f=m(e.getPath(),l);Object.assign(r,u({isCurrent:p,isPartiallyCurrent:f,href:l,location:e})),r.href=l,p&&(r["aria-current"]="page");var h=r.onClick;return r.onClick=function(t){var e;h&&h(t),t.preventDefault(),(e=t).defaultPrevented||0!==e.button||e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||(t.preventDefault(),n(l,{state:i,replace:a}))},I.createElement("a",r)})})},Location:A,LocationProvider:G,Match:function(t){var c=t.path,s=t.children;return I.createElement(J.Consumer,null,function(t){var u=t.baseuri;return I.createElement(A,null,function(t){var e,n,r=t.navigate,o=t.location,i=C(c,u),a=(e=i,n=o.getPath(),P([{path:e}],n));return s({navigate:r,location:o,match:a?Object.assign({},a.params,{uri:a.uri,path:c}):null})})})},Redirect:ct,Router:Q,ServerLocation:function(t){var e=t.url,n=t.children;return I.createElement(z.Provider,{value:{location:{pathname:e},navigate:function(){throw new Error("You can't call navigate on the server.")}}},n)},createHistory:R,createMemorySource:F,isRedirect:it,navigate:S,redirectTo:at}});