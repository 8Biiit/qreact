!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ReachRouter=e()}(this,function(){function t(){try{return window}catch(t){try{return global}catch(t){return F}}}function e(t,e){for(var n in e)R.call(e,n)&&(t[n]=e[n]);return t}function n(t,n){function r(){}var o=t.prototype;r.prototype=n.prototype;var i=t.prototype=new r;return e(i,o),i.constructor=t,i}function r(t,r,o,i){var a=n.getName(t),u=Function("superClass","ctor","return function "+a+" (props, context) {\n            superClass.apply(this, arguments); \n            ctor.apply(this, arguments);\n      }")(r,t);return u.displayName=a,e(n(u,r),o),i&&e(u,i),u}function o(t,e){return t.slice(0,e.length)===e}function i(t,e){if(!t)throw e}function a(t,e){for(var n=void 0,r=void 0,o=v(e.split("?").shift()),a=""===o[0],u=h(t),c=0,s=u.length;c<s;c++){var l=!1,p=u[c].route;if(p.default)r={route:p,params:{},uri:e};else{for(var f=v(p.path),d={},m=Math.max(o.length,f.length),y=0;y<m;y++){var g=f[y],b=o[y];if("*"===g){d["*"]=o.slice(y).map(decodeURIComponent).join("/");break}if(void 0===b){l=!0;break}var E=L.exec(g);if(E&&!a){i(!k.includes(E[1]),'<Router> dynamic segment "'+E[1]+'" is a reserved name. Please use a different name in path "'+p.path+'".');var P=decodeURIComponent(b);d[E[1]]=P}else if(g!==b){l=!0;break}}if(!l){n={route:p,params:d,uri:"/"+o.slice(0,y).join("/")};break}}}return n||r||null}function u(t,e){return a([{path:t}],e)}function c(t,e){if(o(t,"/"))return t;var n=t.split("?"),r=n[0],i=n[1],a=e.split("?").shift(),u=v(r),c=v(a);if(""===u[0])return d(a,i);if(!o(u[0],".")){var s=c.concat(u).join("/");return d(("/"===a?"":"/")+s,i)}for(var l=c.concat(u),p=[],f=0,h=l.length;f<h;f++){var m=l[f];".."===m?p.pop():"."!==m&&p.push(m)}return d("/"+p.join("/"),i)}function s(t,e){return"/"+v(t).map(function(t){var n=L.exec(t);return n?e[n[1]]:t}).join("/")}function l(t,e){var n=function(t){return N(t)};return v(t).filter(n).sort().join("/")===v(e).filter(n).sort().join("/")}function p(t,e){return{route:t,score:t.default?0:v(t.path).reduce(function(t,e){return t+=D,M(e)?t+=U:N(e)?t+=T:K(e)?t-=D+q:t+=S,t},0),index:e}}function f(t,e){return t.score<e.score?1:t.score>e.score?-1:t.index-e.index}function h(t){return t.map(p).sort(f)}function v(t){return t.replace(/(^\/+|\/+$)/g,"").split("/")}function d(t,e){return t+(e?"?"+e:"")}function m(t){return Object.assign({},t.location,{getPath:function(){return"hash"===I.value?this.hash.slice(1):this.pathname},state:t.history.state,key:t.history.state&&t.history.state.key||"initial"})}function y(t){var e=[],n=!1,r=function(){},o={location:m(t),transitioning:n,_onTransitionComplete:function(){o.transitioning=n=!1,r()},listen:function(n){e.push(n);var r=function(e){o.location=m(t),n()},i="hash"===I.value?"hashchange":"popstate";return g(t,i,r),function(){b(t,i,r),e=e.filter(function(t){return t!==n})}},navigate:function(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=a.state,c=a.replace,s=void 0!==c&&c;u=Object.assign({},u,{key:Date.now()+""});var l=t.location;if("hash"===I.value)s&&l.hash!==newHash&&history.back(),l.hash=i;else try{n||s?t.history.replaceState(u,null,i):t.history.pushState(u,null,i)}catch(t){l[s?"replace":"assign"](i)}o.location=m(t),o.transitioning=n=!0;var p=new Promise(function(t){return r=t});return e.forEach(function(t){return t()}),p}};return o}function g(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent&&t.attachEvent("on"+e,n)}function b(t,e,n){t.removeEventListener?t.removeEventListener(e,n):t.detachEvent&&t.detachEvent("on"+e,n)}function E(){function t(t){var o=t.history;o.index=e,o.entries=r,o.state=n[e],t.location=r[e]}var e=0,n=[],r=[{pathname:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",search:""}],o={addEventListener:function(t,e){},removeEventListener:function(t,e){},history:{back:function(){},pushState:function(i,a,u){e++,r.push(P(u)),n.push(i),t(o)},replaceState:function(i,a,u){r[e]=P(u),n[e]=i,t(o)}}};return t(o),o}function P(t){var e=t.split("?");return{pathname:e[0],search:e[1]||""}}function C(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function j(t){return I.value=!Y||t.mode&&"history"!==t.mode?"hash":"history",z.createElement(ot.Consumer,null,function(e){return z.createElement(nt,null,function(n){return z.createElement(it,W({},e,n,t))})})}function x(){}function w(t){this.uri=t}function O(t){return!t.defaultPrevented&&0===t.button&&!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}var R=Object.prototype.hasOwnProperty,F={};n.getName=function(t){return t.name};var k=["uri","path"],L=/^:(.+)/,D=4,S=3,T=2,q=1,U=1,M=function(t){return""==t},N=function(t){return L.test(t)},K=function(t){return"*"===t},I={},$=t(),_=y($.location?$:E()),H=_.navigate,W=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},B=t(),Y=!!B.history&&B.history.pushState,z=B.React;if(!z||!z.eventSystem)throw"请先安装anujs";var A=z.unstable_deferredUpdates,G=z.PropTypes,J=z.cloneElement,Q=z.PureComponent,V=z.createContext,X=z.Children,Z=z.Component;void 0===A&&(A=function(t){return t()});var tt=function(t,e){var n=V(e);return n.Consumer.displayName=t+".Consumer",n.Provider.displayName=t+".Provider",n},et=tt("Location"),nt=function(t){var e=t.children;return z.createElement(et.Consumer,null,function(t){return t?e(t):z.createElement(rt,null,e)})},rt=r(function(){this.state={context:this.getContext(),refs:{unlisten:null}}},Z,{getContext:function(){var t=this.props.history;return{navigate:t.navigate,location:t.location}},componentDidCatch:function(t,e){if(!pt(t))throw t;(0,this.props.history.navigate)(t.uri,{replace:!0})},componentDidUpdate:function(t,e){e.context.location!==this.state.context.location&&this.props.history._onTransitionComplete()},componentDidMount:function(){var t=this,e=this.state.refs,n=this.props.history;e.unlisten=n.listen(function(){Promise.resolve().then(function(){A(function(){t.unmounted||t.setState(function(){return{context:t.getContext()}})})})})},componentWillUnmount:function(){var t=this.state.refs;this.unmounted=!0,t.unlisten()},render:function(){var t=this.state.context,e=this.props.children;return z.createElement(et.Provider,{value:t},"function"==typeof e?e(t):e||null)}},{defaultProps:{history:_}}),ot=tt("Base",{baseuri:"/",basepath:"/"}),it=r(function(){},Q,{render:function(){var t=this.props,e=t.location,n=t.navigate,r=t.basepath,o=t.primary,i=t.children,u=t.component,s=void 0===u?"div":u,l=(t.baseuri,t.mode),p=C(t,["location","navigate","basepath","primary","children","component","baseuri","mode"]),f=a(X.map(i,mt(r)),e.getPath());if(f){var h=f.params,v=f.uri,d=f.route,m=f.route.value;r=d.default?r:d.path.replace(/\*$/,"");var y=Object.assign({},h,{uri:v,location:e,navigate:function(t,e){return n(c(t,v),e)}}),g=J(m,y,m.props.children?z.createElement(j,{primary:o,mode:l},m.props.children):void 0),b=o?ut:s,E=o?Object.assign({uri:v,location:e},p):p;return z.createElement(ot.Provider,{value:{baseuri:v,basepath:r}},z.createElement(b,E,g))}return null}},{defaultProps:{primary:!0}}),at=tt("Focus"),ut=function(t){var e=t.uri,n=t.location,r=C(t,["uri","location"]);return z.createElement(at.Consumer,null,function(t){return z.createElement(lt,W({},r,{requestFocus:t,uri:e,location:n}))})},ct=!0,st=0,lt=r(function(){var t=this;this.state={},this.requestFocus=function(e){t.state.shouldFocus||e.focus()}},Z,{componentDidMount:function(){st++,this.focus()},componentWillUnmount:function(){0===--st&&(ct=!0)},componentDidUpdate:function(t,e){t.location!==this.props.location&&this.state.shouldFocus&&this.focus()},focus:function(){if(!t().process){var e=this.props.requestFocus;e?e(this.node):ct?ct=!1:this.node.focus()}},render:function(){var t=this,e=this.props,n=(e.children,e.style),r=(e.requestFocus,e.role),o=void 0===r?"group":r,i=e.component,a=void 0===i?"div":i,u=(e.uri,e.location,C(e,["children","style","requestFocus","role","component","uri","location"]));return z.createElement(a,W({style:Object.assign({outline:"none"},n),tabIndex:"-1",role:o,ref:function(e){return t.node=e}},u),z.createElement(at.Provider,{value:this.requestFocus},this.props.children))}},{getDerivedStateFromProps:function(t,e){if(null==e.uri)return Object.assign({shouldFocus:!0},t);var n=t.uri!==e.uri,r=t.location.getPath(),o=e.location.getPath()!==r&&r===t.uri;return Object.assign({shouldFocus:n||o},t)}}),pt=function(t){return t instanceof w},ft=function(t){throw new w(t)},ht=r(function(){},Z,{componentDidMount:function(){var t=this.props,e=t.navigate,n=t.to,r=(t.from,t.replace),o=void 0===r||r,i=t.state;t.noThrow;e(s(n,C(t,["navigate","to","from","replace","state","noThrow"])),{replace:o,state:i})},render:function(){var t=this.props,e=(t.navigate,t.to),n=(t.from,t.replace,t.state,t.noThrow),r=C(t,["navigate","to","from","replace","state","noThrow"]);return n||ft(s(e,r)),null}}),vt=function(t){return z.createElement(nt,null,function(e){return z.createElement(ht,W({},e,t))})};vt.propTypes={from:G.string,to:G.string.isRequired};var dt=function(t){return t.replace(/(^\/+|\/+$)/g,"")},mt=function(t){return function(e){if(i(e.props.path||e.props.default||e.type===vt,'<Router>: Children of <Router> must have a "path" or "default" prop, or be a "<Redirect>". \n         None found on element type "'+e.type+'"'),i(!!(e.type!==vt||e.props.from&&e.props.to),'<Redirect from="'+e.props.from+' to="'+e.props.to+'"/> requires both "from" and "to" props when inside a <Router>.'),i(!(e.type===vt&&!l(e.props.from,e.props.to)),'<Redirect from="'+e.props.from+' to="'+e.props.to+'"/> has mismatched dynamic segments, ensure both paths have the exact same dynamic segments.'),e.props.default)return{value:e,default:!0};var n=e.type===vt?e.props.from:e.props.path,r="/"===n?t:dt(t)+"/"+dt(n);return{value:e,default:e.props.default,path:e.props.children?dt(r)+"/*":r}}};return{version:"2.2.0",Link:function(t){return z.createElement(ot.Consumer,null,function(e){e.basepath;var n=e.baseuri;return z.createElement(nt,null,function(e){var r=e.location,i=e.navigate,a={},u=void 0,s=void 0,l=void 0,p=x;for(var f in t){var h=t[f];"to"===f?u=h:"state"===f?s=h:"replace"===f?l=h:"getProps"==f&&h?p=h:a[f]=h}var v=c(u,n),d=r.getPath()===v,m=o(r.getPath(),v);Object.assign(a,p({isCurrent:d,isPartiallyCurrent:m,href:v,location:r})),a.href=v,d&&(a["aria-current"]="page");var y=a.onClick;return a.onClick=function(t){y&&y(t),t.preventDefault(),O(t)&&(t.preventDefault(),i(v,{state:s,replace:l}))},z.createElement("a",a)})})},Location:nt,LocationProvider:rt,Match:function(t){var e=t.path,n=t.children;return z.createElement(ot.Consumer,null,function(t){var r=t.baseuri;return z.createElement(nt,null,function(t){var o=t.navigate,i=t.location,a=u(c(e,r),i.getPath());return n({navigate:o,location:i,match:a?Object.assign({},a.params,{uri:a.uri,path:e}):null})})})},Redirect:vt,Router:j,ServerLocation:function(t){var e=t.url,n=t.children;return z.createElement(et.Provider,{value:{location:{pathname:e},navigate:function(){throw new Error("You can't call navigate on the server.")}}},n)},createHistory:y,createMemorySource:E,isRedirect:pt,navigate:H,redirectTo:ft}});